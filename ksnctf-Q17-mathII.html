
<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="HandheldFriendly" content="True" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="robots" content="" />

  <link href="https://fonts.googleapis.com/css2?family=Source+Code+Pro:ital,wght@0,400;0,700;1,400&family=Source+Sans+Pro:ital,wght@0,300;0,400;0,700;1,400&display=swap" rel="stylesheet">

    <link rel="stylesheet" type="text/css" href="https://kaffebreak.github.io/blog/theme/stylesheet/style.min.css">


    <link id="pygments-light-theme" rel="stylesheet" type="text/css"
          href="https://kaffebreak.github.io/blog/theme/pygments/github.min.css">


  <link rel="stylesheet" type="text/css" href="https://kaffebreak.github.io/blog/theme/font-awesome/css/fontawesome.css">
  <link rel="stylesheet" type="text/css" href="https://kaffebreak.github.io/blog/theme/font-awesome/css/brands.css">
  <link rel="stylesheet" type="text/css" href="https://kaffebreak.github.io/blog/theme/font-awesome/css/solid.css">


    <link href="https://kaffebreak.github.io/blog/feeds/all.atom.xml" type="application/atom+xml" rel="alternate" title="いつか泥になる Atom">



  


 

<meta name="author" content="kaffebreak" />
<meta name="description" content="ヒント:二分探索" />
<meta name="keywords" content="ctf, python">


  <meta property="og:site_name" content="いつか泥になる"/>
  <meta property="og:title" content="ksnctf Q17 mathII"/>
  <meta property="og:description" content="ヒント:二分探索"/>
  <meta property="og:locale" content="en_US"/>
  <meta property="og:url" content="https://kaffebreak.github.io/blog/ksnctf-Q17-mathII.html"/>
  <meta property="og:type" content="article"/>
  <meta property="article:published_time" content="2021-12-04 00:00:00+09:00"/>
  <meta property="article:modified_time" content=""/>
  <meta property="article:author" content="https://kaffebreak.github.io/blog/author/kaffebreak.html">
  <meta property="article:section" content="ctf"/>
  <meta property="article:tag" content="ctf"/>
  <meta property="article:tag" content="python"/>
  <meta property="og:image" content="">

  <title>いつか泥になる &ndash; ksnctf Q17 mathII</title>

</head>
<body class="light-theme">
  <aside>
    <div>
      <a href="https://kaffebreak.github.io/blog/">
        <img src="https://kaffebreak.github.io/blog/theme/img/profile.png" alt="" title="">
      </a>

      <h1>
        <a href="https://kaffebreak.github.io/blog/"></a>
      </h1>




      <ul class="social">
          <li>
            <a  class="sc-github" href="https://github.com/kaffebreak" target="_blank">
              <i class="fab fa-github"></i>
            </a>
          </li>
          <li>
            <a  class="sc-twitter" href="https://twitter.com/is_not_defined" target="_blank">
              <i class="fab fa-twitter"></i>
            </a>
          </li>
      </ul>
    </div>

  </aside>
  <main>


<article class="single">
  <header>
      
    <h1 id="ksnctf-Q17-mathII">ksnctf Q17 mathII</h1>
    <p>
      Posted on 土 04 12月 2021 in <a href="https://kaffebreak.github.io/blog/category/ctf.html">ctf</a>

    </p>
  </header>


  <div>
    <h3>問題文</h3>
<p><a href="https://ksnctf.sweetduet.info/problem/17">Math II - ksnctf</a></p>
<blockquote>
<p>How important is modulo arithmetic in cryptography?</p>
<p>Let
  x = 2748040023408750324411119450523386950660946398855386842074606380418316981389557916980086140301887947706700698930830779678048474531538039134089675000612962004189001422715316147779554460684462041893073445562829316520071658956471592707597247194589999870235577599858641217209525243986680999448565468816434633441308131788183291153809253610695081752296732033298647222814340913466738465892791206393936089466068684809286651197884210187525269355913763182559833600649423167126622527203197940618965341674710993871930168655984019611567024681974446413864111651893113475795042753452042221938667445789706741508160949598322950403760355305740757495122850819958219745478009476321531997688864567881328571570240278649150057863614800304034452842380274161491817926949213762740941829027657311016236224840157689532838274458699038989430527152474540367086746579688987076042252804910459873636444778218434530247647760637770881658596016745610672707638583665201858035977485748775481448417394363801163664632527695106599930657132405666766730530997168969743603771751166591137309462845077320233889570871715682231576283485837079838925927845291565664213349164253238166525895494203520538861102027123057706413048503799598270037162337386882901940037500301040636118696723417952777083334146545991127148023661461455142653367976629308434919237639329808504561590505864983890552051987234096577849288536293631380950881787840319976968198704697701966146561843819563765280293823120028941691560894722032503932540560461794190408016359786029679686957711035845785762377768203676919060935155382104877926736292611130243057909501332528103700463961697932230444978571571548190911155741113324573679444638703192583211952316173122745153529542339170631749363019742630339456502772150867703497326010832217054307087826776870481852284816747574983354077170761286175754243223519482572371717625453405597596790583499145036350302955327521461648262537855645876387858201576107385450844609238327605056916243564458120595540013872075267316304999752934829122583429168665162743589578036716137649553856654996867605565582594039606555708509284616434305172100068285925706963351193710675088846623856567419346569873886366829228933416064828304824833588800700991940600359503453201939139663042787644390810036292415117714919711827630953170559057272633043896443339064006637234499569232762828723613158050896065355005775876910820958296537497557737916521798848004761708690607167573807307291510879396794861418856342383200817566360552405183866698509354047737422523253071467100174078467454351746681775690022510266842064132386305358891086764558955802257688899610117102582837343655907837234028334304769930810792079059216436489942124896722072971246781926084943216581585837400274934104255861076781834022322597318553478829221018993823759479304536464719195824731739557957722610850860725276329731096193041588880149698625007746958307472328762247329346952956782896672291984502790479223886842985800649168009891087704339671376795754679245964575179873102014722210341771266309855717402003098724600141420936602986387680283404929020457247001371544838792904086327642729822000980710278752669990211765608002907900832262843253793831541691706704836397397798869236939393204666502455311086553874765248631328418556164635889080357612074921368044611251307530838475840480894307375072202500636365832958938363048173011687247738236161480446422712858040552310006617829659443118541556912488329721272939472554467384944920030182974546889304443711910957344160175437149714520561879951921970795705645045936350875827028675689840953101114431720413756855193291198455863087675930604549263160397353363504597829924339064422377323361781720524799661393081986371074530022532621955945720583925291264598924971169093688390536693144593482790588893095052569365154072722966434676949346037949263628957665599420417719951187489606010866702371368012263032537375401145460592536898818245350468847674995676417425737655723761467908866712060720593684978725896677308273.</p>
<p>Find the value of y such that y<sup>101</sup> = x.</p>
<p>The flag is FLAG_y (in decimal notation).</p>
</blockquote>
<h3>やってみる</h3>
<p>「累乗根で出せる！」と思ったら、そんな単純な話ではなかった。<br>
値がでかすぎるので、当然オーバーフローしてしまった。<br><br>
yの値に101をべき乗して、xと同じ値を探すのが正攻法らしい。<br>
y=1から一個一個やると果てしなく時間がかかるので、二分探索を使って求める。（らしい）</p>
<h4>答え</h4>
<div class="highlight"><pre><span></span><code><span class="n">x</span> <span class="o">=</span> <span class="mi">2748040023408750324411119450523386950660946398855386842074606380418316981389557916980086140301887947706700698930830779678048474531538039134089675000612962004189001422715316147779554460684462041893073445562829316520071658956471592707597247194589999870235577599858641217209525243986680999448565468816434633441308131788183291153809253610695081752296732033298647222814340913466738465892791206393936089466068684809286651197884210187525269355913763182559833600649423167126622527203197940618965341674710993871930168655984019611567024681974446413864111651893113475795042753452042221938667445789706741508160949598322950403760355305740757495122850819958219745478009476321531997688864567881328571570240278649150057863614800304034452842380274161491817926949213762740941829027657311016236224840157689532838274458699038989430527152474540367086746579688987076042252804910459873636444778218434530247647760637770881658596016745610672707638583665201858035977485748775481448417394363801163664632527695106599930657132405666766730530997168969743603771751166591137309462845077320233889570871715682231576283485837079838925927845291565664213349164253238166525895494203520538861102027123057706413048503799598270037162337386882901940037500301040636118696723417952777083334146545991127148023661461455142653367976629308434919237639329808504561590505864983890552051987234096577849288536293631380950881787840319976968198704697701966146561843819563765280293823120028941691560894722032503932540560461794190408016359786029679686957711035845785762377768203676919060935155382104877926736292611130243057909501332528103700463961697932230444978571571548190911155741113324573679444638703192583211952316173122745153529542339170631749363019742630339456502772150867703497326010832217054307087826776870481852284816747574983354077170761286175754243223519482572371717625453405597596790583499145036350302955327521461648262537855645876387858201576107385450844609238327605056916243564458120595540013872075267316304999752934829122583429168665162743589578036716137649553856654996867605565582594039606555708509284616434305172100068285925706963351193710675088846623856567419346569873886366829228933416064828304824833588800700991940600359503453201939139663042787644390810036292415117714919711827630953170559057272633043896443339064006637234499569232762828723613158050896065355005775876910820958296537497557737916521798848004761708690607167573807307291510879396794861418856342383200817566360552405183866698509354047737422523253071467100174078467454351746681775690022510266842064132386305358891086764558955802257688899610117102582837343655907837234028334304769930810792079059216436489942124896722072971246781926084943216581585837400274934104255861076781834022322597318553478829221018993823759479304536464719195824731739557957722610850860725276329731096193041588880149698625007746958307472328762247329346952956782896672291984502790479223886842985800649168009891087704339671376795754679245964575179873102014722210341771266309855717402003098724600141420936602986387680283404929020457247001371544838792904086327642729822000980710278752669990211765608002907900832262843253793831541691706704836397397798869236939393204666502455311086553874765248631328418556164635889080357612074921368044611251307530838475840480894307375072202500636365832958938363048173011687247738236161480446422712858040552310006617829659443118541556912488329721272939472554467384944920030182974546889304443711910957344160175437149714520561879951921970795705645045936350875827028675689840953101114431720413756855193291198455863087675930604549263160397353363504597829924339064422377323361781720524799661393081986371074530022532621955945720583925291264598924971169093688390536693144593482790588893095052569365154072722966434676949346037949263628957665599420417719951187489606010866702371368012263032537375401145460592536898818245350468847674995676417425737655723761467908866712060720593684978725896677308273</span>


<span class="n">lo</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">hi</span> <span class="o">=</span> <span class="nb">pow</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">100</span><span class="p">)</span>

<span class="k">while</span> <span class="kc">True</span><span class="p">:</span>
    <span class="n">md</span> <span class="o">=</span> <span class="p">(</span><span class="n">lo</span> <span class="o">+</span> <span class="n">hi</span><span class="p">)</span> <span class="o">//</span> <span class="mi">2</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">md</span><span class="p">)</span>
    <span class="k">if</span> <span class="nb">pow</span><span class="p">(</span><span class="n">md</span><span class="p">,</span> <span class="mi">101</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">x</span><span class="p">:</span>
        <span class="n">hi</span> <span class="o">=</span> <span class="n">md</span> <span class="o">-</span> <span class="mi">1</span>
    <span class="k">elif</span> <span class="nb">pow</span><span class="p">(</span><span class="n">md</span><span class="p">,</span> <span class="mi">101</span><span class="p">)</span> <span class="o">&lt;</span> <span class="n">x</span><span class="p">:</span>
        <span class="n">lo</span> <span class="o">=</span> <span class="n">md</span> <span class="o">+</span> <span class="mi">1</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">md</span><span class="p">)</span>
        <span class="k">break</span>
</code></pre></div>

<p>timeモジュールで<code>time.sleep(0.25)</code>でちょっと遅らせると、値が求められていく様子が見えて面白い。  </p>
<h3>参考文献</h3>
<p><a href="https://www.cyamax.com/entry/2017/09/03/004419">ksnctf #17 Math II - 俺より凄いやつしかいない。</a></p>
  </div>
  <div class="tag-cloud">
    <p>
      <a href="https://kaffebreak.github.io/blog/tag/ctf.html">ctf</a>
      <a href="https://kaffebreak.github.io/blog/tag/python.html">python</a>
    </p>
  </div>





</article>

    <footer>
<p>&copy;  </p>
<p>
Built with <a href="http://getpelican.com" target="_blank">Pelican</a> using <a href="http://bit.ly/flex-pelican" target="_blank">Flex</a> theme
</p>    </footer>
  </main>




<script type="application/ld+json">
{
  "@context" : "http://schema.org",
  "@type" : "Blog",
  "name": " いつか泥になる ",
  "url" : "https://kaffebreak.github.io/blog",
  "image": "",
  "description": ""
}
</script>

</body>
</html>